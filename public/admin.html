<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Photo Management</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    h1, h2, h3 {
      color: #e05297;
    }
    .container {
      background-color: #fff;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    input[type="text"], textarea, select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
    }
    textarea {
      height: 100px;
    }
    button {
      background-color: #e05297;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background-color: #c23d7c;
    }
    .photo-item, .moment-item {
      margin-bottom: 15px;
      padding: 15px;
      border: 1px solid #eee;
      border-radius: 4px;
    }
    .note {
      background-color: #fffbea;
      padding: 15px;
      border-left: 4px solid #ffeb3b;
      margin-bottom: 20px;
    }
    .tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 1px solid #ddd;
    }
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border: 1px solid transparent;
      border-bottom: none;
      margin-right: 5px;
    }
    .tab.active {
      background-color: #fff;
      border-color: #ddd;
      border-radius: 5px 5px 0 0;
      color: #e05297;
      font-weight: bold;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
  </style>
</head>
<body>
  <h1>Photo and Moment Management</h1>
  
  <div class="note">
    <h3>Important Instructions</h3>
    <p>1. First, upload your photos to the website using the Replit file explorer.</p>
    <p>2. Put photos in the /public/photos folder and moments in the /public/moments folder.</p>
    <p>3. Once uploaded, refer to them with file paths like: /photos/your-photo.jpg</p>
    <p>4. Use the forms below to add, view, or delete photos and special moments.</p>
  </div>

  <div class="tabs">
    <div class="tab active" data-tab="photos">Photos</div>
    <div class="tab" data-tab="moments">Special Moments</div>
    <div class="tab" data-tab="instructions">Instructions</div>
  </div>

  <div id="photos-tab" class="tab-content active">
    <div class="container">
      <h2>Add New Photo</h2>
      <form id="photo-form">
        <div class="form-group">
          <label for="photo-title">Title:</label>
          <input type="text" id="photo-title" required>
        </div>
        
        <div class="form-group">
          <label for="photo-description">Description:</label>
          <textarea id="photo-description"></textarea>
        </div>
        
        <div class="form-group">
          <label for="photo-url">URL (path to your uploaded photo):</label>
          <input type="text" id="photo-url" placeholder="/photos/your-photo.jpg" required>
        </div>
        
        <div class="form-group">
          <label for="photo-category">Category:</label>
          <select id="photo-category">
            <option value="dates">Dates</option>
            <option value="trips">Trips</option>
            <option value="everyday">Everyday</option>
            <option value="special">Special</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="photo-date">Date:</label>
          <input type="text" id="photo-date" placeholder="June 15, 2023" required>
        </div>
        
        <button type="submit">Add Photo</button>
      </form>
    </div>

    <div class="container">
      <h2>Current Photos</h2>
      <div id="photos-list"></div>
    </div>
  </div>

  <div id="moments-tab" class="tab-content">
    <div class="container">
      <h2>Add New Special Moment</h2>
      <form id="moment-form">
        <div class="form-group">
          <label for="moment-title">Title:</label>
          <input type="text" id="moment-title" required>
        </div>
        
        <div class="form-group">
          <label for="moment-description">Description:</label>
          <textarea id="moment-description" required></textarea>
        </div>
        
        <div class="form-group">
          <label for="moment-imageUrl">Image URL (path to your uploaded photo):</label>
          <input type="text" id="moment-imageUrl" placeholder="/moments/your-photo.jpg" required>
        </div>
        
        <div class="form-group">
          <label for="moment-date">Date:</label>
          <input type="text" id="moment-date" placeholder="June 15, 2023" required>
        </div>
        
        <div class="form-group">
          <label for="moment-tag">Tag:</label>
          <select id="moment-tag">
            <option value="First Date">First Date</option>
            <option value="Anniversary">Anniversary</option>
            <option value="Travel">Travel</option>
            <option value="Celebration">Celebration</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="moment-tagColor">Tag Color:</label>
          <select id="moment-tagColor">
            <option value="primary">Primary (Pink)</option>
            <option value="secondary">Secondary (Purple)</option>
            <option value="accent">Accent (Blue)</option>
          </select>
        </div>
        
        <button type="submit">Add Moment</button>
      </form>
    </div>

    <div class="container">
      <h2>Current Special Moments</h2>
      <div id="moments-list"></div>
    </div>
  </div>

  <div id="instructions-tab" class="tab-content">
    <div class="container">
      <h2>Detailed Instructions</h2>
      
      <h3>How to Upload Photos</h3>
      <ol>
        <li>In the Replit file explorer, navigate to the <code>/public</code> folder.</li>
        <li>Inside you'll see <code>/photos</code> and <code>/moments</code> folders.</li>
        <li>Click on one of these folders.</li>
        <li>Click the "Upload file" button or drag and drop your photos directly.</li>
        <li>Wait for the upload to complete.</li>
      </ol>
      
      <h3>Adding Photos to the Gallery</h3>
      <ol>
        <li>After uploading your photos to <code>/public/photos</code>, go to the Photos tab.</li>
        <li>Fill in the form with the photo details.</li>
        <li>For the URL field, enter <code>/photos/filename.jpg</code> (replace filename.jpg with your actual filename).</li>
        <li>Click "Add Photo" to save it to the database.</li>
      </ol>
      
      <h3>Adding Special Moments</h3>
      <ol>
        <li>After uploading your photos to <code>/public/moments</code>, go to the Moments tab.</li>
        <li>Fill in the form with the moment details.</li>
        <li>For the Image URL field, enter <code>/moments/filename.jpg</code> (replace filename.jpg with your actual filename).</li>
        <li>Click "Add Moment" to save it to the database.</li>
      </ol>
      
      <h3>Troubleshooting</h3>
      <ul>
        <li>If your photo doesn't appear, double-check the path. It should be relative to the public folder.</li>
        <li>Make sure file names match exactly, including uppercase/lowercase letters.</li>
        <li>If you get errors, try refreshing the page and trying again.</li>
      </ul>
    </div>
  </div>

  <script>
    // Tab switching logic
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
        
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab + '-tab').classList.add('active');
      });
    });
    
    // Fetch all photos and moments when the page loads
    document.addEventListener('DOMContentLoaded', () => {
      fetchPhotos();
      fetchMoments();
    });
    
    // Photo form submission
    document.getElementById('photo-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const photo = {
        title: document.getElementById('photo-title').value,
        description: document.getElementById('photo-description').value,
        url: document.getElementById('photo-url').value,
        category: document.getElementById('photo-category').value,
        date: document.getElementById('photo-date').value
      };
      
      try {
        const response = await fetch('/api/photos', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(photo)
        });
        
        if (response.ok) {
          alert('Photo added successfully!');
          document.getElementById('photo-form').reset();
          fetchPhotos();
        } else {
          const error = await response.json();
          alert(`Error: ${error.message}`);
        }
      } catch (error) {
        alert(`Error: ${error.message}`);
      }
    });
    
    // Moment form submission
    document.getElementById('moment-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const moment = {
        title: document.getElementById('moment-title').value,
        description: document.getElementById('moment-description').value,
        imageUrl: document.getElementById('moment-imageUrl').value,
        date: document.getElementById('moment-date').value,
        tag: document.getElementById('moment-tag').value,
        tagColor: document.getElementById('moment-tagColor').value
      };
      
      try {
        const response = await fetch('/api/moments', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(moment)
        });
        
        if (response.ok) {
          alert('Moment added successfully!');
          document.getElementById('moment-form').reset();
          fetchMoments();
        } else {
          const error = await response.json();
          alert(`Error: ${error.message}`);
        }
      } catch (error) {
        alert(`Error: ${error.message}`);
      }
    });
    
    // Fetch all photos
    async function fetchPhotos() {
      try {
        const response = await fetch('/api/photos');
        const photos = await response.json();
        
        const photosList = document.getElementById('photos-list');
        photosList.innerHTML = '';
        
        photos.forEach(photo => {
          const photoItem = document.createElement('div');
          photoItem.className = 'photo-item';
          photoItem.innerHTML = `
            <h3>${photo.title}</h3>
            <p><strong>Description:</strong> ${photo.description || 'No description'}</p>
            <p><strong>Category:</strong> ${photo.category}</p>
            <p><strong>Date:</strong> ${photo.date}</p>
            <p><strong>Image URL:</strong> ${photo.url}</p>
            <img src="${photo.url}" alt="${photo.title}" style="max-width: 200px; max-height: 150px; object-fit: cover;">
            <button class="delete-photo" data-id="${photo.id}">Delete</button>
          `;
          photosList.appendChild(photoItem);
        });
        
        // Add event listeners to delete buttons
        document.querySelectorAll('.delete-photo').forEach(button => {
          button.addEventListener('click', async () => {
            if (confirm('Are you sure you want to delete this photo?')) {
              const id = button.dataset.id;
              try {
                const response = await fetch(`/api/photos/${id}`, {
                  method: 'DELETE'
                });
                
                if (response.ok) {
                  alert('Photo deleted successfully!');
                  fetchPhotos();
                } else {
                  const error = await response.json();
                  alert(`Error: ${error.message}`);
                }
              } catch (error) {
                alert(`Error: ${error.message}`);
              }
            }
          });
        });
      } catch (error) {
        console.error('Error fetching photos:', error);
      }
    }
    
    // Fetch all moments
    async function fetchMoments() {
      try {
        const response = await fetch('/api/moments');
        const moments = await response.json();
        
        const momentsList = document.getElementById('moments-list');
        momentsList.innerHTML = '';
        
        moments.forEach(moment => {
          const momentItem = document.createElement('div');
          momentItem.className = 'moment-item';
          momentItem.innerHTML = `
            <h3>${moment.title}</h3>
            <p><strong>Description:</strong> ${moment.description}</p>
            <p><strong>Date:</strong> ${moment.date}</p>
            <p><strong>Tag:</strong> ${moment.tag}</p>
            <p><strong>Tag Color:</strong> ${moment.tagColor}</p>
            <p><strong>Image URL:</strong> ${moment.imageUrl}</p>
            <img src="${moment.imageUrl}" alt="${moment.title}" style="max-width: 200px; max-height: 150px; object-fit: cover;">
            <button class="delete-moment" data-id="${moment.id}">Delete</button>
          `;
          momentsList.appendChild(momentItem);
        });
        
        // Add event listeners to delete buttons
        document.querySelectorAll('.delete-moment').forEach(button => {
          button.addEventListener('click', async () => {
            if (confirm('Are you sure you want to delete this moment?')) {
              const id = button.dataset.id;
              try {
                const response = await fetch(`/api/moments/${id}`, {
                  method: 'DELETE'
                });
                
                if (response.ok) {
                  alert('Moment deleted successfully!');
                  fetchMoments();
                } else {
                  const error = await response.json();
                  alert(`Error: ${error.message}`);
                }
              } catch (error) {
                alert(`Error: ${error.message}`);
              }
            }
          });
        });
      } catch (error) {
        console.error('Error fetching moments:', error);
      }
    }
  </script>
</body>
</html>